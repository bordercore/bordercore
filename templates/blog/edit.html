{% extends "base.html" %}

{% block extra_head %}

<script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-tokenizer.js"></script>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/bootstrap-tokenizer.css" />

{% endblock %}

{% block title %} Blog {% endblock %}

{% block content %}

{% include "blog/header.html" %}

<script type="text/javascript" src="{{ STATIC_URL }}/js/jquery.field_selection.js"></script>
<script type="text/javascript">

$(document).ready(function() {

	$("input[name='tags']").tokenizer( { delimiters: [13, 188] } )

	$('#escape').click( function(event) {

		var range = $('textarea').getSelection();
		var text = $('textarea').val();
		var escapedText = range.text.replace(/</g, "&lt;").replace(/>/g, "&gt;");
		$('textarea').val( text.substr(0, range.start) + escapedText +  text.substr(range.end, text.length - range.end));

	})

});

</script>

<script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-datepicker.js"></script>
<link href="{{ STATIC_URL }}css/datepicker.css" rel="stylesheet" media="screen" />

<script type="text/javascript">

$(document).ready(function() {

	$('#datepicker').datepicker().on('changeDate', function(ev){ });
});

</script>

{% if request.POST.Go and not form.errors %}

<div class="alert alert-success">
Post {{ action }}ed
</div>

{% endif %}

<p class="lead offset2"> {{ action }} a Blog Post</p>

<form class="form-horizontal" action="{{ request.path }}" method="post">
{% csrf_token %}

{% for field in form %}
<div class="control-group {% if field.errors %}error{% endif %}">
    <label class="control-label" for="inputTitle">{{ field.label }}</label>

    <div class="controls">
{% if field.label == 'Date' %}

	<div class="input-large date" id="datepicker" data-date="{{ field.value|date:"m-d-Y" }}" data-date-format="mm-dd-yyyy">
	  <input class="span2" size="16" type="text" name="date" value="{{ field.value|date:"m-d-Y" }}" />
	  <span class="add-on"><i class="icon-th"></i></span>
    </div>

{% else %}

{{ field }}

{% endif %}

{% for error in field.errors %}
      <span class="form-error">{{ error }}</span>
{% endfor %}

    </div>

</div>
{% endfor %}

  <div class="control-group">
    <div class="controls">
	  <input class="btn" type="submit" name="Go" value="{{ action }}">
	  <input class="btn{% if not form.instance.id %} disabled{% endif %}" type="submit" name="Go" value="Delete">
	  <a class="btn" href="{% url 'blog_list' %}">Cancel</a>
	</div>
  </div>

</form>

{% endblock %}
