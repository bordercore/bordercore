{% extends "base.html" %}

{% block title %} Fitness :: Summary {% endblock %}

{% block extra_head %}
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.20/sl-1.3.1/datatables.min.css"/>
{% endblock %}

{% block content %}

    <div id="vue-message">
    {% include "common/show_messages.html" %}
    </div>

    <h1>Active Exercises</h1>

    <div class="table_container">
        <table class="table" id="active_exercises"80%">

            <thead>
                <tr>
                    <th>Exercise</th>
                    <th>Muscle Group</th>
                    <th>Interval</th>
                    <th>Last Workout</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>

    {% for exercise in active_exercises %}

        <tr{% if exercise.overdue %} class="selected"{% endif %}>
            <td><a href="{% url 'fitness:exercise_detail' exercise.uuid %}">{{ exercise.exercise }}</a></td>
            <td>{{ exercise.muscle.muscle_group }}</td>
            <td>{{ exercise.interval.days }} day{{ exercise.interval.days|pluralize:"s" }}</td>
            {% if exercise.last_active %}
                <td>{{ exercise.last_active|date:"N j, Y" }} <span class="float-right">{{ exercise.delta_days }} day{{ exercise.delta_days|pluralize:"s" }} ago</span></td>
            {% else %}
                <td>Never</td>
            {% endif %}
            <td></td>
            <td></td>
        </tr>

    {% endfor %}

        </table>
    </div>

    <h1>Inactive Exercises</h1>

    <div class="table_container">
        <table class="table" id="inactive_exercises">

            <thead>
                <tr>
                    <th>Exercise</th>
                    <th>Muscle Group</th>
                    <th>Last Workout</th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>

    {% for exercise in inactive_exercises %}

        <tr>
            <td><a href="{% url 'fitness:exercise_detail' exercise.uuid %}">{{ exercise.exercise }}</a></td>
            <td>{{ exercise.muscle.muscle_group }}</td>
            {% if exercise.last_active %}
                <td>{{ exercise.last_active|date:"N j, Y" }} <span class="float-right">{{ exercise.delta_days }} day{{ exercise.delta_days|pluralize:"s" }} ago</span></td>
            {% else %}
                <td>Never</td>
            {% endif %}
            <td></td>
            <td></td>
            <td></td>
        </tr>

    {% endfor %}

        </table>
    </div>

{% endblock %}

{% block javascript %}

    {{ block.super }}

    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.20/sl-1.3.1/datatables.min.js"></script>

    <script type="text/javascript">

        new Vue({
            el: "#vue-message",
        });

        var metadata = []
        var table;

        $(document).ready(function() {

            table = $('#active_exercises, #inactive_exercises').DataTable( {
                initComplete: function () {
                    var api = this.api();
                    $('#active_exercises, #inactive_exercises').show();
                    api.columns.adjust();
                },
                "columnDefs": [
                    { "targets": [3], "dataSort": 4 },
                    { "targets": [4,5], "visible": false },
                ],
                info: false,
                language: {
                    'emptyTable': 'No exercises found'
                },
                paging: false,
                searching: false,
                "sorting": [[3, 'asc']],
            });

            // The "Inactive Exercises" table has one less column, so turn this invisible
            $( "#inactive_exercises" ).dataTable().api().column(3).visible(false);

        });

    </script>

{% endblock %}
