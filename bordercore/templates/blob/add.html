{% extends "base.html" %}

{% block title %} Blob {% endblock %}

{% block content %}

    <script type="text/javascript">

        $(document).ready(function() {

            $("input[type='file']").change( function(){
                $("button[type='submit']").removeAttr("disabled");
                $("input[name='filename']").val( $('#new-blob').val() )
            });

        });

    </script>

    {% if messages %}
        {% for message in messages %}
            <div class="col-md-7 col-md-offset2 alert alert-danger">
                {{ message|safe }}
            </div>
        {% endfor %}
    {% endif %}

    <form class="form-horizontal" enctype="multipart/form-data" action="{% url 'blob_add' %}" method="post">
        <input type="hidden" name="replaced_sha1sum" value="{{ replaced_sha1sum_info.sha1sum }}" />
        {% csrf_token %}

        {% if replaced_sha1sum_info %}
            <div class="col-md-7 col-md-offset2 alert alert-info">
                  Replacing <strong>{{ replaced_sha1sum_info.metadata.title|default:replaced_sha1sum_info.sha1sum }}</strong>
            </div>
        {% endif %}

            <div class="col-md-7 col-md-offset2">

                <p class="lead">Choose blob from filesystem</p>

                <input type="hidden" name="filename" />

                <div class="form-group">
                    <div class="controls">
                        <input type="file" id="new-blob" name="blob" class="form-control col-md-5" />
                    </div>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-default" name="upload" disabled="true">Add</button>
                    <a class="btn btn-default" href="{% url 'music_list' %}">Cancel</a>
                </div>

            </div>

    </form>

{% endblock %}
